# Postman

Postman - это масштабируемый инструмент тестирования API, который быстро интегрируется в конвейер CI/CD.
Он был создан индийским программистом Abhinav Asthana (сейчас живет и работает в Силиконовой долине) в 2012 году как побочный проект для упрощения рабочего процесса при разработке и тестировании API.

В разработке ПО, CI (continuous integration)/CD (continuous delivery или continuous deployment) или CICD — это комбинация непрерывной интеграции и непрерывного развертывания программного обеспечения в процессе разработки.
CI/CD объединяет разработку, тестирование и развёртывание приложения.
В настоящий момент DevOps-программисты стремятся применять CI/CD практически для всех задач.

Зачем использовать Postman?
Как использовать Postman для выполнения запросов к API
Работа с GET запросами
Работа с POST запросами
Как параметризовать запросы
Как создавать тесты
Как создавать коллекции
Как запускать коллекции с помощью программы запуска коллекций
Как запускать коллекции с помощью Newman

Зачем использовать Postman?
Более чем 4 миллиона программистов в настоящее время используют программное обеспечение Postman по следующим причинам:

Доступность – Чтобы использовать инструмент Postman, нужно просто войти в свою учетную запись, что облегчает доступ к файлам в любое время и в любом месте.
Использование коллекций – Postman позволяет пользователям создавать коллекции для своих вызовов API Postman. Каждая коллекция может создавать вложенные папки и несколько запросов. Это помогает в организации ваших наборов тестов.
Совместная работа – Коллекции и среды могут быть импортированы или экспортированы, что упрощает обмен файлами. Прямая ссылка также может быть использована для обмена коллекциями.
Создание сред – Наличие нескольких сред способствует меньшему повторению тестов, так как можно использовать одну и ту же коллекцию, но для другой среды. Именно здесь будет происходить параметризация, которую мы обсудим в дальнейшем.
Создание тестов – Контрольные точки тестирования, такие как проверка статуса успешного ответа HTTP, могут быть добавлены к каждому вызову API Postman, что помогает обеспечить тестирование.
Автоматизированное тестирование – С помощью программы сбора данных или Newman тесты можно выполнять в несколько итераций, экономя время на повторяющиеся тесты.
Отладка – Консоль Postman помогает проверить, какие данные были получены, что упрощает отладку тестов.
Непрерывная интеграция – Благодаря своей способности поддерживать непрерывную интеграцию поддерживаются методы разработки.


Как использовать Postman для выполнения запросов к API
Давайте рассмотрим пошаговый процесс использования Postman и различные функции инструментов Postman
New – Здесь вы создадите новый запрос, коллекцию или среду.
Import – Это используется для импорта коллекции или среды. Существуют такие опции, как импорт из файла, папки, ссылка или вставка необработанного текста.
Runner – Тесты автоматизации могут быть выполнены с помощью программы сбора данных. Это будет обсуждаться далее в следующем блоке.
Open New – Откройте новую вкладку, Окно Postman или Окно Runner, нажав эту кнопку.
My Workspace – Вы можете создать новое рабочее пространство индивидуально или в команде
Invite – Сотрудничайте в рабочей области, приглашая членов команды.
History – Прошлые запросы, которые вы отправляли, будут отображаться в истории. Это позволяет легко отслеживать выполненные вами действия.
Collections – Организуйте свой набор тестов, создавая коллекции. Каждая коллекция может содержать вложенные папки и несколько запросов. Запрос или папка также могут быть продублированы.
Request tab – Здесь отображается заголовок запроса, над которым вы работаете. По умолчанию “Untitled Request” будет отображаться для запросов без названий.
HTTP Request – При нажатии на эту кнопку отобразится раскрывающийся список различных запросов, таких как GET, POST, COPY, DELETE, etc. В Postman API тестировании, наиболее часто используемые запросы - GET и POST.
Request URL – Также известный как конечная точка, это место, где вы определите ссылку, с которой будет взаимодействовать API.
Save –Если в запросе есть изменения, необходимо нажать кнопку Сохранить, чтобы новые изменения не были потеряны или перезаписаны.
Params – Здесь вы напишете параметры, необходимые для запроса, такие как значения ключей.
Authorization – Для доступа к API-интерфейсам необходима авторизация. Это может быть в виде имени пользователя и пароля, токена на предъявителя (bearer token) и т.д.
Headers – Вы можете задать заголовки, такие как тип контента JSON, в зависимости от запроса.
Body – Именно здесь можно настроить детали в запросе, обычно используемом в запросе POST.
Pre-request Script – Это сценарии, которые будут выполняться перед запросом. Обычно сценарии предварительного запроса для среды настройки используются для обеспечения того, чтобы тесты выполнялись в правильной среде.
Tests – Это сценарии, выполняемые во время запроса. Важно иметь тесты, поскольку он устанавливает контрольные точки, чтобы проверить, в порядке ли статус ответа, получены ли ожидаемые данные и другие тесты.

Работа с POST-запросами
Запросы Post отличаются от запроса Get, так как пользователь манипулирует данными, добавляя данные в конечную точку. Используя те же данные из предыдущего урока в запросе Get, давайте теперь добавим нашего собственного пользователя.

Шаг 1) Щелкните новую вкладку, чтобы создать новый запрос.


Шаг 2) В новой вкладке

Установите для HTTP-запроса значение POST.
Введите ту же ссылку в URL запроса: https://jsonplaceholder.typicode.com/users
переключиться на вкладку «Тело»

Шаг 3) В теле,

Нажмите необработанный
Выберите JSON

Шаг 4) Скопируйте и вставьте только один пользовательский результат из предыдущего запроса на получение, как показано ниже. Убедитесь, что код был скопирован правильно с парными фигурными скобками и скобками. Измените идентификатор на 11 и имя на любое желаемое имя. Вы также можете изменить другие данные, такие как адрес.

[ { "id": 11, "name": "Кришна Рунгта", "username": "Bret", "email": "Sincere@april.biz", "address": { "street": "Kulas Light" , "suite": "Квартира 556", "city": "Gwenborough", "zipcode": "92998-3874", "geo": { "lat": "-37.3159", "lng": "81.1496" } }, "телефон": "1-770-736-8031 x56442", "веб-сайт": "hildegard.org", "company": { "name": "Romaguera-Crona", "catchPhrase": "Multi- многоуровневая нейронная сеть клиент-сервер", "bs": "используйте электронные рынки в реальном времени" } } ]


*Примечание. Запрос онлайн-публикации должен иметь правильный формат, чтобы обеспечить создание запрошенных данных. Рекомендуется использовать Get first для проверки формата JSON запроса. Вы можете использовать такие инструменты, как https://jsonformatter.curiousconcept.com/


Шаг 5) Далее,

Щелкните Отправить.
Статус: 201 Создано должно отображаться
Опубликованные данные отображаются в теле.

Как параметризовать запросы


Параметризация данных — одна из самых полезных функций Postman. Вместо создания одинаковых запросов с разными данными можно использовать переменные с параметрами. Эти данные могут быть из файла данных или переменной среды. Параметризация помогает избежать повторения одних и тех же тестов, а итерации можно использовать для автоматизированного тестирования .

Параметры создаются с помощью двойных фигурных скобок: {{sample}}. Давайте посмотрим на пример использования параметров в нашем предыдущем запросе:


Теперь давайте создадим параметризовать запрос на получение.

Шаг 1)

Установите для HTTP-запроса значение GET.
Введите эту ссылку: https://jsonplaceholder.typicode.com/users . Замените первую часть ссылки параметром, например {{url}}. URL-адрес запроса теперь должен быть {{url}}/users.
Нажмите отправить.
Ответа быть не должно, так как мы не установили источник нашего параметра.


Шаг 2) Чтобы использовать параметр, вам необходимо установить среду

Щелкните значок глаза
Щелкните Изменить, чтобы установить для переменной глобальную среду, которую можно использовать во всех коллекциях.

Шаг 3) В переменной

установите имя на URL-адрес https://jsonplaceholder.typicode.com
нажмите Сохранить.

Шаг 4) Нажмите «Закрыть», если вы видите следующий экран.


Шаг 5) Вернитесь к своему запросу Get и нажмите «Отправить». Теперь должны быть результаты для вашего запроса.


*Примечание: всегда убедитесь, что ваши параметры имеют источник, такой как переменная среды или файл данных, чтобы избежать ошибок.


Как создавать тесты почтальона
Тесты Postman — это коды JavaScript, добавляемые к запросам, которые помогают вам проверять результаты, такие как успешное или неудачное состояние, сравнение ожидаемых результатов и т. д. Обычно он начинается с pm.test. Его можно сравнить с утверждениями, командами проверки, доступными в других инструментах.

Давайте проведем базовое тестирование API с помощью Postman для наших запросов параметризации из предыдущего урока.


Шаг 1) Перейдите к запросу пользователя GET из предыдущего руководства.

Перейдите на вкладку тестов. Справа находятся коды сниппетов.
В разделе фрагментов нажмите «Код состояния: код 200».
Панель заполняется автоматически


Шаг 2) Теперь нажмите «Отправить». Теперь должен отображаться результат теста.


Шаг 3) Вернитесь на вкладку тестов и давайте добавим еще один тест. На этот раз мы сравним ожидаемый результат с фактическим результатом.

В разделе фрагментов нажмите «Тело ответа: проверка значения JSON». Мы проверим, есть ли у Линн Грэм идентификатор пользователя 1.


Шаг 4)

Замените «Имя вашего теста» в коде на «Проверить, является ли пользователь с id1 Линн Грэм», чтобы имя теста точно указывало на то, что мы хотим протестировать.
Замените jsonData.value на jsonData[0].name. Чтобы получить путь, проверьте тело в Получить результат ранее. Поскольку Линн Грэм имеет идентификатор пользователя 1, jsonData находится в первом результате, который должен начинаться с 0. Если вы хотите получить второй результат, используйте jsonData[1] и так далее для последующих результатов.
В eql введите «Leanne Graham»
pm.test("Проверить, является ли пользователь с id1 Линн Грэм", function () { var jsonData = pm.response.json(); pm.expect(jsonData[0].name).to.eql("Линн Грэм" ); });


Шаг 5) Нажмите «Отправить». Теперь должно быть два пройденных результата теста для вашего запроса.


*Примечание. В Postman можно создавать разные типы тестов. Попробуйте изучить инструмент и посмотреть, какие тесты будут соответствовать вашим потребностям.

Как создавать коллекции
Коллекции играют важную роль в организации наборов тестов. Его можно импортировать и экспортировать, что упрощает обмен коллекциями в команде. В этом уроке мы узнаем, как создать и выполнить коллекцию.

Приступим к созданию коллекции:

Шаг 1) Нажмите кнопку «Создать» в верхнем левом углу страницы.


Шаг 2) Выберите Коллекция. Должно появиться окно создания коллекции.


Шаг 3) Введите желаемое название коллекции и описание, затем нажмите «Создать». Теперь должна быть создана коллекция.


Шаг 4) Вернитесь к предыдущему запросу Get. Нажмите Сохранить


Шаг 5)

Выберите Сборник тестов почтальона.
Нажмите «Сохранить в тестовую коллекцию Postman».

Шаг 6) Тестовая коллекция Postman теперь должна содержать один запрос.


Шаг 7) Повторите шаги 4-5 для предыдущего запроса на публикацию, чтобы теперь в коллекции было два запроса.


Как запускать коллекции с помощью Collection Runner
Существует два способа запустить коллекцию: средство управления коллекцией и метод Ньюмана. Начнем с запуска коллекции в Collection Runner.

Шаг 1) Нажмите кнопку Runner в верхней части страницы рядом с кнопкой Import.


Шаг 2) Должна появиться страница Collection Runner, как показано ниже. Ниже приводится описание различных полей.


Шаг 3) Запустите тестовую коллекцию Postman, настроив следующее:

Выберите тестовую коллекцию Postman. Установите итерации как 3.
Установить задержку 2500 мс
Нажмите кнопку «Выполнить тест почтальона…».

Шаг 4) Страница результатов запуска должна отображаться после нажатия кнопки «Выполнить». В зависимости от задержки вы должны увидеть тесты по мере их выполнения.

После завершения тестов вы можете увидеть статус теста, если он пройден или не пройден, а также результаты каждой итерации.
Вы видите статус прохождения для запросов на получение
Так как тестов для Post у нас не было, то должно быть сообщение, что в запросе не было тестов.

Вы можете видеть, насколько важно, чтобы в ваших запросах были тесты, чтобы вы могли проверить статус HTTP-запроса в случае успеха, а данные были созданы или получены.

Как запускать коллекции с помощью Newman
Другой способ управлять коллекцией — через Newman. Основные различия между Newman и Collection Runner заключаются в следующем:

Newman — это дополнение к Postman. Вам нужно будет установить его отдельно от родного приложения.
Ньюман использует командную строку, в то время как Collection Runner имеет графический интерфейс.
Newman можно использовать для непрерывной интеграции.
Чтобы установить Newman и запустить из него нашу коллекцию, делаем следующее:

Шаг 1) Установите nodejs по этой ссылке: http://nodejs.org/download/

Шаг 2) Откройте командную строку и введите

npm установить -g ньюман

Теперь Newman должен быть установлен на вашем компьютере.


Шаг 3) После того, как Newman будет установлен, давайте вернемся в нашу рабочую область Postman. В поле «Коллекции» щелкните три точки. Теперь должны появиться параметры. Выберите Экспорт.


Шаг 4) Выберите «Экспортировать коллекцию как коллекцию v2.1 (рекомендуется)», затем нажмите «Экспортировать».


Шаг 5) Выберите нужное место и нажмите «Сохранить». Желательно создать специальную папку для ваших тестов Postman. Теперь коллекция должна быть экспортирована в выбранный вами локальный каталог.

Шаг 6) Нам также нужно будет экспортировать нашу среду. Щелкните значок глаза рядом с раскрывающимся списком среды в разделе «Глобальные», выберите «Загрузить как JSON». Выберите нужное место и нажмите Сохранить. Желательно, чтобы среда находилась в той же папке, что и ваша коллекция.


Шаг 7) Теперь среда должна быть экспортирована в тот же локальный каталог, что и Коллекция.

Шаг 8) Теперь вернитесь в командную строку и измените каталог, в котором вы сохранили коллекцию и среду.

cd C:\Users\Asus\Desktop\Postman Tutorial

Шаг 9) Запустите свою коллекцию с помощью этой команды:

newman запустить PostmanTestCollection.postman_collection.json -e Testing.postman_globals.json

Теперь результаты запуска должны появиться, как показано ниже.


Для руководства есть ссылка на некоторые основные коды Ньюмана для выполнения:

Запуск только коллекции. Это можно использовать, если нет среды или файла тестовых данных dependency.newman run <имя коллекции>
Запустите коллекцию и среду. Индикатор -e предназначен для среды. newman run <имя коллекции> -e <имя среды>
Запустите сбор с желаемым номером. of iterations.newman run <имя коллекции> -n <число итераций>
Запуск с файлом данных. newman run <имя коллекции> --data <имя файла> -n <число итераций> -e <имя среды>
Установить время задержки. Это важно, так как тесты могут завершиться неудачно, если они выполняются без задержки из-за запуска запросов без завершения обработки предыдущего запроса на сервере конечной точки.
newman run <название коллекции> -d <время задержки>
